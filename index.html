<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ù†Ø¬Ø¯</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Lalezar&family=Vazirmatn:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #6B8E23; 
            --dark-green: #3A5210;
            --light-bg: #f8f9fa;      
            --selected-bg: #eef5e0;   
            --text-color: #444;
            --shadow: 0 10px 30px rgba(0,0,0,0.08);
            --gold-color: #FFD700; /* Ø±Ù†Ú¯ Ø·Ù„Ø§ÛŒÛŒ Ø¨Ø±Ø§ÛŒ Ø³ØªØ§Ø±Ù‡ */
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            margin: 0; padding: 0 0 100px 0;
            background-color: var(--light-bg);
            color: var(--text-color);
            overflow-x: hidden; /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø³Ú©Ø±ÙˆÙ„ Ø§ÙÙ‚ÛŒ */
            -webkit-tap-highlight-color: transparent;
            width: 100vw; /* Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø¹Ø±Ø¶ Ú©Ø§Ù…Ù„ */
        }

        /* --- Ù‡Ø¯Ø± --- */
        .header {
            position: relative;
            background: linear-gradient(135deg, #557C18 0%, #2d420b 100%);
            padding: 40px 20px 70px 20px;
            border-radius: 0 0 40px 40px;
            text-align: center; overflow: hidden;
            box-shadow: 0 10px 25px rgba(45, 66, 11, 0.3); z-index: 10;
        }
        .header-bg-icon {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 10rem; color: rgba(255,255,255,0.03); pointer-events: none;
        }
        .header h1 {
            font-family: 'Lalezar', cursive; margin: 0; font-size: 3.5rem; color: #fff;
            text-shadow: 0 4px 15px rgba(0,0,0,0.3); position: relative; z-index: 2;
            animation: fadeInDown 1s ease-out;
        }
        .header p {
            font-family: 'Vazirmatn', sans-serif; font-weight: 300; margin: 5px 0 0; 
            color: rgba(255, 255, 255, 0.85); font-size: 1rem; position: relative; z-index: 2;
            animation: fadeInUp 1s ease-out 0.3s backwards;
        }
        
        /* Ø¯Ú©Ù…Ù‡ Ù…Ù†ÙˆÛŒ Ù‡Ù…Ø¨Ø±Ú¯Ø±ÛŒ */
        .menu-toggle-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            z-index: 20;
            padding: 5px;
        }

        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Ú©Ø§Ù†ØªÛŒÙ†Ø± Ùˆ Ø¬Ø³ØªØ¬Ùˆ --- */
        .container { padding: 0 20px 20px; max-width: 1200px; margin: 0 auto; }
        .search-container { position: relative; margin-top: -35px; margin-bottom: 35px; z-index: 20; }
        #search-input {
            width: 100%; padding: 18px 50px 18px 20px; font-size: 1.1rem;
            font-family: 'Vazirmatn', sans-serif; border-radius: 50px; border: none;
            background-color: #fff; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            color: #555; box-sizing: border-box;
        }
        #search-input:focus { outline: none; box-shadow: 0 15px 30px rgba(107, 142, 35, 0.25); }
        .search-icon { position: absolute; right: 25px; top: 50%; transform: translateY(-50%); color: var(--primary-color); font-size: 1.3rem; pointer-events: none; }

        /* --- Ù…Ù†ÙˆÛŒ Ø¬Ø§Ù†Ø¨ÛŒ (BlurView) - Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ --- */
        .side-menu-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.3); z-index: 998;
            opacity: 0; visibility: hidden; transition: all 0.3s ease;
            backdrop-filter: blur(3px);
        }
        .side-menu {
            position: fixed; top: 0; right: -300px; width: 280px; height: 100%;
            background: rgba(20, 30, 10, 0.9); /* Ø³Ø¨Ø² Ø¨Ø³ÛŒØ§Ø± ØªÛŒØ±Ù‡ */
            backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px);
            z-index: 999; box-shadow: -5px 0 20px rgba(0,0,0,0.2);
            padding: 20px; display: flex; flex-direction: column;
            color: white;
            /* Ø§ØµÙ„Ø§Ø­ Ø§ØµÙ„ÛŒ: ÙˆÙ‚ØªÛŒ Ø¨Ø³ØªÙ‡ Ø§Ø³Øª Ú©Ø§Ù…Ù„Ø§ Ù…Ø®ÙÛŒ Ø´ÙˆØ¯ ØªØ§ ÙØ¶Ø§ Ù†Ú¯ÛŒØ±Ø¯ */
            visibility: hidden; 
            transition: right 0.4s cubic-bezier(0.19, 1, 0.22, 1), visibility 0s linear 0.4s;
        }
        .side-menu.active { 
            right: 0; 
            visibility: visible;
            transition: right 0.4s cubic-bezier(0.19, 1, 0.22, 1), visibility 0s linear 0s;
        }
        .side-menu-overlay.active { opacity: 1; visibility: visible; }

        .side-menu-header {
            display: flex; justify-content: space-between; align-items: center;
            padding-bottom: 15px; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 20px;
        }
        .close-menu-btn { background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; }
        .fav-list-container { overflow-y: auto; flex-grow: 1; }
        .fav-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .fav-item i { color: #ff4757; cursor: pointer; padding: 5px; }

        /* --- Ú©Ø§Ø´ÛŒâ€ŒÙ‡Ø§ --- */
        .categories-grid { 
            display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); 
            gap: 18px; padding-bottom: 20px; 
        }
        @media (min-width: 480px) { .categories-grid { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 25px; } }

        .category-tile {
            position: relative; color: white; border-radius: 25px; overflow: hidden;
            display: flex; flex-direction: column; justify-content: center; align-items: center; 
            height: 170px; padding: 10px; box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); cursor: pointer;
        }
        .category-tile:active { transform: scale(0.95); }
        .category-tile:hover { transform: translateY(-5px); }

        /* Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ú©Ø§Ø´ÛŒâ€ŒÙ‡Ø§ */
        .cat-special { background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%); border: 1px solid rgba(255,255,255,0.1); }
        .cat-mixer { background: linear-gradient(135deg, #8E2DE2 0%, #4A00E0 100%); box-shadow: 0 10px 20px rgba(74, 0, 224, 0.3); }
        .cat-herbs { background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%); }
        .cat-spices { background: linear-gradient(135deg, #ff512f 0%, #dd2476 100%); }
        .cat-liquids { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .cat-oils { background: linear-gradient(135deg, #f09819 0%, #edde5d 100%); }
        .cat-grains { background: linear-gradient(135deg, #EB3349 0%, #F45C43 100%); }
        .cat-hygiene { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
        .cat-food { background: linear-gradient(135deg, #FF8008 0%, #FFC837 100%); }
        .cat-misc { background: linear-gradient(135deg, #6190E8 0%, #A7BFE8 100%); }

        .tile-content { position: relative; z-index: 2; text-align: center; width: 100%; }
        .tile-content i { font-size: 3rem; margin-bottom: 10px; color: #fff; filter: drop-shadow(0 4px 4px rgba(0,0,0,0.2)); }
        .tile-content h2 { font-family: 'Lalezar', cursive; margin: 0; font-size: 1.4rem; text-shadow: 0 2px 5px rgba(0,0,0,0.2); }

        /* --- Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ --- */
        .inner-section { display: none; margin-top: 20px; background-color: white; padding: 25px; border-radius: 25px; box-shadow: var(--shadow); }
        .back-btn { 
            background-color: #f0f2f5; color: #555; border: none; padding: 10px 20px; 
            border-radius: 15px; cursor: pointer; font-family: 'Vazirmatn', sans-serif; font-weight: 700;
            margin-bottom: 20px; display: inline-flex; align-items: center; gap: 8px;
        }

        /* --- Ù„ÛŒØ³Øª Ù…Ø­ØµÙˆÙ„Ø§Øª (ØªØºÛŒÛŒØ± Ú¯Ø±ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ø¬Ø§ Ø¯Ø§Ø¯Ù† Ø³ØªØ§Ø±Ù‡) --- */
        .product-list { list-style: none; padding: 0; margin: 0; }
        .product-item {
            display: grid; 
            grid-template-columns: auto auto 1fr auto; /* Ø³ØªØ§Ø±Ù‡ | Ú†Ú© Ø¨Ø§Ú©Ø³ | Ù†Ø§Ù… | ØªØ¹Ø¯Ø§Ø¯ */
            align-items: center;
            gap: 10px; padding: 15px 10px; border-bottom: 1px solid #f4f4f4;
            transition: background-color 0.2s; border-radius: 12px; margin-bottom: 5px;
        }
        .product-item.selected { background-color: var(--selected-bg); border: 1px solid var(--primary-color); }
        .product-checkbox { width: 24px; height: 24px; accent-color: var(--primary-color); }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø³ØªØ§Ø±Ù‡ */
        .star-btn {
            background: none; border: none; cursor: pointer; font-size: 1.2rem; color: #ccc;
            transition: all 0.3s ease; padding: 5px;
        }
        .star-btn.active {
            color: var(--gold-color);
            animation: starPop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        @keyframes starPop {
            0% { transform: scale(1); }
            50% { transform: scale(1.5); }
            100% { transform: scale(1); }
        }

        .quantity-input-container { display: none; align-items: center; gap: 10px; }
        .product-item.selected .quantity-input-container { display: flex; }
        .quantity-input { width: 50px; padding: 5px; border: 2px solid #dce6c5; border-radius: 10px; text-align: center; font-weight: bold; color: var(--primary-color); }
        .delete-btn { color: #ff4757; background: #ffeef0; border-radius: 10px; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; cursor: pointer; }

        /* --- Ø¨Ø®Ø´ Ø³ÙØ§Ø±Ø´ Ø®Ø§Øµ --- */
        .special-form { display: flex; flex-direction: column; gap: 20px; }
        .form-control { width: 100%; padding: 15px; border: 2px solid #eee; border-radius: 15px; font-family: 'Vazirmatn'; font-size: 1rem; box-sizing: border-box; }
        .btn-submit-special { background: linear-gradient(135deg, #203a43, #2c5364); color: white; padding: 15px; border: none; border-radius: 15px; font-size: 1.1rem; font-family: 'Lalezar'; width: 100%; cursor: pointer; }

        /* --- Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…ÛŒÚ©Ø³Ø± (GAME) --- */
        .mixer-wrapper { display: flex; flex-direction: column; align-items: center; gap: 20px; }
        
        .size-selector {
            display: flex; background: #eee; padding: 5px; border-radius: 50px;
            width: 100%; max-width: 350px; margin-bottom: 10px;
        }
        .size-btn {
            flex: 1; border: none; background: transparent; padding: 10px;
            border-radius: 40px; cursor: pointer; font-family: 'Lalezar'; font-size: 1rem; color: #666;
            transition: all 0.3s ease;
        }
        .size-btn.active { background: #fff; color: #8E2DE2; box-shadow: 0 2px 10px rgba(0,0,0,0.1); transform: scale(1.05); }

        .supplements-shelf {
            display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;
            background: #8B5E3C; padding: 15px 10px 25px 10px; border-radius: 15px;
            width: 100%; box-sizing: border-box; position: relative;
            box-shadow: inset 0 10px 20px rgba(0,0,0,0.4), 0 5px 15px rgba(0,0,0,0.2);
            border-bottom: 8px solid #5D3A1A;
        }
        .supplement-jar {
            background: linear-gradient(to right, rgba(255,255,255,0.8), rgba(255,255,255,0.5));
            border-radius: 5px; height: 55px; display: flex; flex-direction: column; align-items: center;
            cursor: grab; position: relative; box-shadow: 0 5px 5px rgba(0,0,0,0.2);
            transition: transform 0.1s;
        }
        .supplement-jar:active { transform: scale(0.9); cursor: grabbing; }
        .jar-lid { width: 70%; height: 6px; background: #333; margin-top: -3px; border-radius: 2px; }
        .jar-body { width: 100%; height: 100%; border-radius: 5px; display: flex; align-items: center; justify-content: center; }
        .jar-body span { font-size: 0.6rem; font-weight: bold; color: rgba(0,0,0,0.6); writing-mode: vertical-rl; transform: rotate(180deg); }

        .mixing-area {
            position: relative; width: 100%; height: 260px;
            display: flex; justify-content: center; align-items: flex-end;
        }
        .flask-container {
            position: relative; width: 160px; height: 220px;
            display: flex; flex-direction: column-reverse; align-items: center;
        }
        .flask-glass {
            position: relative; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.1);
            border: 4px solid rgba(255, 255, 255, 0.6);
            border-top: none;
            border-radius: 0 0 20px 20px;
            clip-path: polygon(20% 0, 80% 0, 100% 100%, 0% 100%);
            overflow: hidden; z-index: 2; backdrop-filter: blur(2px);
            box-shadow: inset 0 -10px 20px rgba(255,255,255,0.3), 0 10px 20px rgba(0,0,0,0.1);
        }
        .flask-neck {
            position: absolute; top: -35px; left: 50%; transform: translateX(-50%);
            width: 50px; height: 40px; background: rgba(255, 255, 255, 0.1);
            border: 4px solid rgba(255, 255, 255, 0.6); border-bottom: none; border-radius: 5px 5px 0 0;
            z-index: 1;
        }
        .powder-layer { width: 100%; transition: height 0.4s cubic-bezier(0.4, 2, 0.55, 0.44); border-top: 1px solid rgba(255,255,255,0.2); }
        
        .particle {
            position: absolute; top: 0; width: 6px; height: 6px; border-radius: 50%;
            animation: fall 0.6s linear forwards; z-index: 5; pointer-events: none;
        }
        @keyframes fall {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(150px) scale(0.5); opacity: 0; }
        }

        .flask-stats {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            font-size: 1.8rem; font-weight: bold; color: #333; text-shadow: 0 0 10px rgba(255,255,255,0.8);
            z-index: 10; pointer-events: none; font-family: 'Lalezar', cursive;
            background: rgba(255,255,255,0.6); padding: 5px 15px; border-radius: 20px;
        }

        .completed-mixes { width: 100%; border-top: 2px dashed #ddd; padding-top: 15px; margin-top: 15px; }
        .mix-item {
            background: white; padding: 10px; border-radius: 12px; margin-bottom: 8px;
            display: flex; justify-content: space-between; align-items: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .delete-mix-btn { color: red; background: #ffeeee; border: none; padding: 5px 10px; border-radius: 8px; cursor: pointer; }

        .drag-ghost {
            position: fixed; pointer-events: none; z-index: 9999; width: 50px; height: 50px;
            opacity: 0.9; border-radius: 50%; box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            display: none; align-items: center; justify-content: center; font-size: 20px;
            color: white; font-weight: bold; border: 2px solid white;
        }

        /* --- Ø¯Ú©Ù…Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾ --- */
        .whatsapp-fab {
            position: fixed; bottom: 25px; left: 25px; 
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white; width: 65px; height: 65px; border-radius: 50%; display: flex;
            justify-content: center; align-items: center; font-size: 2.5rem;
            box-shadow: 0 10px 25px rgba(37, 211, 102, 0.4); text-decoration: none;
            transform: scale(0); transition: all 0.4s; cursor: pointer; z-index: 1000;
        }
        .whatsapp-fab.visible { transform: scale(1); }
        .whatsapp-fab:hover { transform: scale(1.1) rotate(10deg); }
        .cart-counter {
            position: absolute; top: 0; right: 0; background-color: #ff4757;
            color: white; border-radius: 50%; width: 24px; height: 24px;
            font-size: 0.8rem; font-weight: bold; display: flex; justify-content: center; align-items: center; border: 2px solid white;
        }
        #loading { text-align: center; padding: 40px; color: #888; }
    </style>
</head>
<body>

    <header class="header">
        <button class="menu-toggle-btn" onclick="toggleMenu()"><i class="fa-solid fa-bars"></i></button>
        <i class="fa-solid fa-leaf header-bg-icon"></i>
        <h1>ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ù†Ø¬Ø¯</h1>
        <p>Ø·Ø¨ÛŒØ¹Øª Ø±Ø§ Ø¨Ù‡ Ø®Ø§Ù†Ù‡ Ø®ÙˆØ¯ Ø¨ÛŒØ§ÙˆØ±ÛŒØ¯</p>
    </header>

    <!-- Ù…Ù†ÙˆÛŒ Ø¬Ø§Ù†Ø¨ÛŒ Ù‡Ù…Ø¨Ø±Ú¯Ø±ÛŒ -->
    <div class="side-menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>
    <div class="side-menu" id="sideMenu">
        <div class="side-menu-header">
            <h3 style="margin:0; font-family:'Lalezar'; font-size:1.5rem; color:var(--gold-color)">Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§</h3>
            <button class="close-menu-btn" onclick="toggleMenu()">Ã—</button>
        </div>
        <div class="fav-list-container" id="favoritesList">
            <!-- Ù„ÛŒØ³Øª Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
            <div style="text-align: center; color: rgba(255,255,255,0.6); margin-top: 20px; font-size: 0.9rem;">Ù„ÛŒØ³Øª Ø®Ø§Ù„ÛŒ Ø§Ø³Øª</div>
        </div>
        <div style="text-align: center; font-size: 0.8rem; color: rgba(255,255,255,0.4); padding-top:10px;">Senjed Store v2.0</div>
    </div>

    <div class="container">
        <div class="search-container">
            <i class="fa-solid fa-search search-icon"></i>
            <input type="search" id="search-input" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ù…Ø­ØµÙˆÙ„Ø§Øª..." autocomplete="off">
        </div>

        <!-- Ù…Ù†ÙˆÛŒ Ø§ØµÙ„ÛŒ (Ú©Ø§Ø´ÛŒâ€ŒÙ‡Ø§) -->
        <div id="category-view">
            <div class="categories-grid">
                <div class="category-tile cat-special" onclick="showSection('special-request-view')">
                    <div class="tile-content"><i class="fa-solid fa-star"></i><h2>Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„ Ø®Ø§Øµ</h2></div>
                </div>
                <div class="category-tile cat-mixer" onclick="initMixer(); showSection('mixer-view')">
                    <div class="tile-content"><i class="fa-solid fa-flask"></i><h2>Ù…ÛŒÚ©Ø³ Ù…Ú©Ù…Ù„ (Ø¯Ù„Ø®ÙˆØ§Ù‡)</h2></div>
                </div>
                <!-- Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§ -->
                <div class="category-tile cat-herbs" data-category="Ú¯ÛŒØ§Ù‡Ø§Ù†-Ø¯Ø§Ø±ÙˆÛŒÛŒ"><div class="tile-content"><i class="fa-solid fa-leaf"></i><h2>Ú¯ÛŒØ§Ù‡Ø§Ù† Ø¯Ø§Ø±ÙˆÛŒÛŒ</h2></div></div>
                <div class="category-tile cat-spices" data-category="Ø§Ø¯ÙˆÛŒÙ‡-Ø¬Ø§Øª"><div class="tile-content"><i class="fa-solid fa-mortar-pestle"></i><h2>Ø§Ø¯ÙˆÛŒÙ‡â€ŒØ¬Ø§Øª</h2></div></div>
                <div class="category-tile cat-liquids" data-category="Ø¹Ø±Ù‚ÛŒØ§Øª"><div class="tile-content"><i class="fa-solid fa-bottle-droplet"></i><h2>Ø¹Ø±Ù‚ÛŒØ§Øª</h2></div></div>
                <div class="category-tile cat-oils" data-category="Ø±ÙˆØºÙ†-Ù‡Ø§"><div class="tile-content"><i class="fa-solid fa-oil-well"></i><h2>Ø±ÙˆØºÙ†â€ŒÙ‡Ø§</h2></div></div>
                <div class="category-tile cat-grains" data-category="Ø­Ø¨ÙˆØ¨Ø§Øª-Ùˆ-ØºÙ„Ø§Øª"><div class="tile-content"><i class="fa-solid fa-wheat-awn"></i><h2>Ø­Ø¨ÙˆØ¨Ø§Øª</h2></div></div>
                <div class="category-tile cat-hygiene" data-category="Ø´ÙˆÛŒÙ†Ø¯Ù‡-Ùˆ-Ø¨Ù‡Ø¯Ø§Ø´ØªÛŒ"><div class="tile-content"><i class="fa-solid fa-pump-soap"></i><h2>Ø¨Ù‡Ø¯Ø§Ø´ØªÛŒ</h2></div></div>
                <div class="category-tile cat-food" data-category="Ù…Ø­ØµÙˆÙ„Ø§Øª-Ø®ÙˆØ±Ø§Ú©ÛŒ"><div class="tile-content"><i class="fa-solid fa-jar"></i><h2>Ø®ÙˆØ±Ø§Ú©ÛŒ</h2></div></div>
                <div class="category-tile cat-misc" data-category="Ù…ØªÙØ±Ù‚Ù‡"><div class="tile-content"><i class="fa-solid fa-box-open"></i><h2>Ø³Ø§ÛŒØ±</h2></div></div>
            </div>
        </div>

        <!-- ØµÙØ­Ù‡ Ù…Ø­ØµÙˆÙ„Ø§Øª -->
        <div id="product-view" class="inner-section">
            <button class="back-btn" onclick="showCategoryView()"><i class="fa-solid fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª</button>
            <h2 id="product-category-title" style="color: var(--primary-color); font-family: 'Lalezar';"></h2>
            <div id="loading">Ø¯Ø±Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
            <ul id="product-list" class="product-list"></ul>
        </div>

        <!-- ØµÙØ­Ù‡ Ø³ÙØ§Ø±Ø´ Ø®Ø§Øµ -->
        <div id="special-request-view" class="inner-section">
            <button class="back-btn" onclick="showCategoryView()"><i class="fa-solid fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª</button>
            <h2 style="font-family: 'Lalezar'; color: #203a43;">Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„ Ú©Ù…ÛŒØ§Ø¨</h2>
            <div class="special-form">
                <input type="text" id="special-name" class="form-control" placeholder="Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„">
                <input type="text" id="special-details" class="form-control" placeholder="ØªÙˆØ¶ÛŒØ­Ø§Øª Ùˆ ÙˆØ²Ù† (Ù…Ø«Ù„Ø§: ÛµÛ°Û° Ú¯Ø±Ù…)">
                <button class="btn-submit-special" onclick="sendSpecialRequest()"><i class="fab fa-whatsapp"></i> Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾</button>
            </div>
        </div>

        <!-- ØµÙØ­Ù‡ Ù…ÛŒÚ©Ø³Ø± (Ø¯Ù„Ø®ÙˆØ§Ù‡) -->
        <div id="mixer-view" class="inner-section" style="background: #fff9fc;">
            <button class="back-btn" onclick="showCategoryView()"><i class="fa-solid fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª</button>
            
            <div class="mixer-wrapper">
                <h2 style="font-family: 'Lalezar'; color: #8E2DE2; margin:0;">Ø¢Ø²Ù…Ø§ÛŒØ´Ú¯Ø§Ù‡ Ù…Ú©Ù…Ù„</h2>
                
                <div class="size-selector">
                    <button class="size-btn" onclick="setMixerSize(500, 50, this)">Ù†ÛŒÙ… Ú©ÛŒÙ„Ùˆ</button>
                    <button class="size-btn active" onclick="setMixerSize(1000, 100, this)">ÛŒÚ© Ú©ÛŒÙ„Ùˆ</button>
                    <button class="size-btn" onclick="setMixerSize(5000, 250, this)">Ù¾Ù†Ø¬ Ú©ÛŒÙ„Ùˆ</button>
                </div>

                <div class="supplements-shelf" id="shelf"></div>

                <div class="mixing-area">
                    <div class="flask-container" id="flask-target">
                        <div class="flask-neck"></div>
                        <div class="flask-glass" id="flask-content"></div>
                        <div class="flask-stats"><span id="current-weight">0</span>g</div>
                    </div>
                </div>

                <div class="completed-mixes">
                    <h4 style="margin: 0 0 10px 0; color: #555;">ØªØ±Ú©ÛŒØ¨â€ŒÙ‡Ø§ÛŒ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø±Ø³Ø§Ù„:</h4>
                    <div id="mix-list">
                        <small style="color: #999; display:block; text-align:center;">Ù‡Ù†ÙˆØ² ØªØ±Ú©ÛŒØ¨ÛŒ Ù†Ø³Ø§Ø®ØªÙ‡â€ŒØ§ÛŒØ¯.</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="whatsapp-button" class="whatsapp-fab">
        <i class="fab fa-whatsapp"></i>
        <span id="cart-counter" class="cart-counter"></span>
    </div>

    <div id="drag-ghost" class="drag-ghost"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const whatsappNumber = "989918022066";
            
            // Ø¹Ù†Ø§ØµØ± Ø¹Ù…ÙˆÙ…ÛŒ
            const categoryView = document.getElementById('category-view');
            const productList = document.getElementById('product-list');
            const categoryTitle = document.getElementById('product-category-title');
            const loadingDiv = document.getElementById('loading');
            const whatsappBtn = document.getElementById('whatsapp-button');
            const cartCounter = document.getElementById('cart-counter');
            const searchInput = document.getElementById('search-input');
            const sideMenu = document.getElementById('sideMenu');
            const menuOverlay = document.getElementById('menuOverlay');
            const favoritesListEl = document.getElementById('favoritesList');

            let allProducts = [];
            let shoppingCart = []; 
            let mixedProducts = []; 
            // Ù„ÛŒØ³Øª Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ Ø§Ø² Ù„ÙˆÚ©Ø§Ù„ Ø§Ø³ØªÙˆØ±ÛŒØ¬
            let favorites = JSON.parse(localStorage.getItem('senjedFavorites')) || [];

            // --- Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ù†Ùˆ ---
            window.toggleMenu = function() {
                sideMenu.classList.toggle('active');
                menuOverlay.classList.toggle('active');
                updateFavoritesMenu();
            }

            // --- Ù…Ø¯ÛŒØ±ÛŒØª Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒâ€ŒÙ‡Ø§ ---
            window.toggleFavorite = function(productName) {
                const idx = favorites.indexOf(productName);
                if(idx === -1) {
                    favorites.push(productName);
                } else {
                    favorites.splice(idx, 1);
                }
                localStorage.setItem('senjedFavorites', JSON.stringify(favorites));
                
                // Ø¢Ù¾Ø¯ÛŒØª Ø¸Ø§Ù‡Ø± Ø³ØªØ§Ø±Ù‡â€ŒÙ‡Ø§ Ø¯Ø± Ù„ÛŒØ³Øª ÙØ¹Ù„ÛŒ
                const btn = document.querySelector(`.star-btn[data-fav-name="${productName}"]`);
                if(btn) {
                    btn.classList.toggle('active');
                    const icon = btn.querySelector('i');
                    if(btn.classList.contains('active')) {
                        icon.classList.remove('fa-regular');
                        icon.classList.add('fa-solid');
                    } else {
                        icon.classList.remove('fa-solid');
                        icon.classList.add('fa-regular');
                    }
                }
                updateFavoritesMenu();
            }

            function updateFavoritesMenu() {
                favoritesListEl.innerHTML = '';
                if(favorites.length === 0) {
                    favoritesListEl.innerHTML = '<div style="text-align: center; color: rgba(255,255,255,0.6); margin-top: 20px; font-size: 0.9rem;">Ù„ÛŒØ³Øª Ø®Ø§Ù„ÛŒ Ø§Ø³Øª</div>';
                    return;
                }
                favorites.forEach(name => {
                    const div = document.createElement('div');
                    div.className = 'fav-item';
                    div.innerHTML = `
                        <span>${name}</span>
                        <i class="fa-solid fa-trash" onclick="toggleFavorite('${name}')"></i>
                    `;
                    favoritesListEl.appendChild(div);
                });
            }

            // --- Ù†Ø§ÙˆØ¨Ø±ÛŒ ---
            window.showCategoryView = function() {
                document.querySelectorAll('.inner-section').forEach(el => el.style.display = 'none');
                categoryView.style.display = 'block';
                window.scrollTo(0, 0);
            }
            window.showSection = function(id) {
                categoryView.style.display = 'none';
                document.querySelectorAll('.inner-section').forEach(el => el.style.display = 'none');
                document.getElementById(id).style.display = 'block';
                window.scrollTo(0, 0);
            }

            // --- Ù…Ø¯ÛŒØ±ÛŒØª Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ùˆ Ø¯Ú©Ù…Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾ ---
            function updateCartAndButton() {
                const standardItems = [];
                document.querySelectorAll('.product-checkbox:checked').forEach(checkbox => {
                    const name = checkbox.dataset.name;
                    const unit = checkbox.dataset.unit;
                    const qInput = document.getElementById(`qty-${name}`);
                    standardItems.push({ name, quantity: qInput.value || 1, unit, type: 'standard' });
                });

                shoppingCart = [...standardItems, ...mixedProducts];

                if (shoppingCart.length > 0) {
                    whatsappBtn.classList.add('visible');
                    cartCounter.textContent = shoppingCart.length;
                } else {
                    whatsappBtn.classList.remove('visible');
                }
            }

            // --- Ø±Ù†Ø¯Ø± Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¹Ø§Ø¯ÛŒ (ÙˆÛŒØ±Ø§ÛŒØ´ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø³ØªØ§Ø±Ù‡) ---
            function renderProductList(productsToShow, title) {
                productList.innerHTML = '';
                categoryTitle.textContent = title;
                loadingDiv.style.display = 'none';

                if (productsToShow.length === 0) {
                    productList.innerHTML = '<li style="text-align:center; color:#777; padding:20px;">Ù…Ø­ØµÙˆÙ„ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</li>';
                    return;
                }
                productsToShow.sort((a, b) => a.name.localeCompare(b.name, 'fa'));

                productsToShow.forEach(product => {
                    const item = document.createElement('li');
                    item.className = 'product-item';
                    const inCart = shoppingCart.find(i => i.name === product.name && i.type === 'standard');
                    const isSel = !!inCart;
                    if(isSel) item.classList.add('selected');

                    // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ø¹Ù„Ø§Ù‚Ù‡â€ŒÙ…Ù†Ø¯ÛŒ
                    const isFav = favorites.includes(product.name);
                    const starClass = isFav ? 'active' : '';
                    const starIcon = isFav ? 'fa-solid' : 'fa-regular';

                    if (product.available) {
                        item.innerHTML = `
                            <button class="star-btn ${starClass}" data-fav-name="${product.name}" onclick="toggleFavorite('${product.name}')">
                                <i class="${starIcon} fa-star"></i>
                            </button>
                            <input type="checkbox" class="product-checkbox" id="prod-${product.name}" 
                                   data-name="${product.name}" data-unit="${product.unit || 'Ø¹Ø¯Ø¯'}" ${isSel ? 'checked' : ''}>
                            <label for="prod-${product.name}" class="product-name">${product.name}</label>
                            <div class="quantity-input-container">
                                <input type="number" min="1" class="quantity-input" id="qty-${product.name}" value="${inCart ? inCart.quantity : '1'}">
                                <span style="font-size:0.8rem; color:#888;">${product.unit || 'Ø¹Ø¯Ø¯'}</span>
                                <div class="delete-btn"><i class="fa-solid fa-trash-can"></i></div>
                            </div>
                        `;
                    } else {
                        item.innerHTML = `<span class="product-name" style="text-decoration: line-through; color:#aaa;">${product.name}</span><span class="status-badge" style="background:#fff0f0; color:red;">Ù†Ø§Ù…ÙˆØ¬ÙˆØ¯</span>`;
                    }
                    productList.appendChild(item);
                });
            }

            // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø¹Ø§Ø¯ÛŒ
            productList.addEventListener('change', (e) => {
                if (e.target.classList.contains('product-checkbox')) {
                    const li = e.target.closest('.product-item');
                    if (e.target.checked) {
                        li.classList.add('selected');
                        setTimeout(() => li.querySelector('.quantity-input').focus(), 50);
                    } else {
                        li.classList.remove('selected');
                    }
                    updateCartAndButton();
                }
            });
            productList.addEventListener('click', (e) => {
                if (e.target.closest('.delete-btn')) {
                    const li = e.target.closest('.product-item');
                    li.querySelector('.product-checkbox').checked = false;
                    li.classList.remove('selected');
                    updateCartAndButton();
                }
            });
            productList.addEventListener('input', (e) => { if(e.target.classList.contains('quantity-input')) updateCartAndButton(); });

            // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø¯Ø³ØªÙ‡â€ŒÙ‡Ø§
            document.querySelectorAll('.category-tile[data-category]').forEach(tile => {
                tile.addEventListener('click', function() {
                    const cat = this.dataset.category;
                    const name = this.querySelector('h2').textContent;
                    renderProductList(allProducts.filter(p => p.category === cat), name);
                    showSection('product-view');
                });
            });

            // Ø¬Ø³ØªØ¬Ùˆ (ÙÛŒÚ©Ø³ Ø´Ø¯Ù‡: Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù†Ù…Ø§ÛŒ Ø¯Ø³ØªÙ‡)
            searchInput.addEventListener('input', () => {
                const term = searchInput.value.trim().toLowerCase();
                if (term) {
                    categoryView.style.display = 'none';
                    document.querySelectorAll('.inner-section').forEach(el => el.style.display = 'none');
                    document.getElementById('product-view').style.display = 'block';
                    renderProductList(allProducts.filter(p => p.name.toLowerCase().includes(term)), `Ù†ØªØ§ÛŒØ¬: Â«${term}Â»`);
                } else {
                    showCategoryView();
                }
            });

            // --- Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ ÙˆØ§ØªØ³â€ŒØ§Ù¾ ---
            whatsappBtn.addEventListener('click', () => {
                updateCartAndButton();
                if (shoppingCart.length === 0) return;
                let msg = "Ø³Ù„Ø§Ù… ÙØ±ÙˆØ´Ú¯Ø§Ù‡ Ø³Ù†Ø¬Ø¯ØŒ Ø³ÙØ§Ø±Ø´ Ù…Ù†:\n\n";
                
                const std = shoppingCart.filter(i => i.type === 'standard');
                if(std.length) {
                    msg += "ğŸ“¦ Ù…Ø­ØµÙˆÙ„Ø§Øª:\n";
                    std.forEach(i => msg += `â–ªï¸ ${i.name}: ${i.quantity} ${i.unit}\n`);
                }

                const mix = shoppingCart.filter(i => i.type === 'mix');
                if(mix.length) {
                    msg += "\nğŸ§ª ØªØ±Ú©ÛŒØ¨â€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ:\n";
                    mix.forEach(i => msg += `â–ªï¸ ${i.name} (${i.quantity} Ø¸Ø±Ù)\n   (ÙˆØ²Ù†: ${i.weightLabel})\n   Ù…Ø­ØªÙˆÛŒØ§Øª: ${i.details}\n`);
                }
                window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(msg)}`, '_blank');
            });

            // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ (Ù…ÙˆÙ‚Øª)
            fetch('products.json?v=' + Date.now()).then(res => res.json()).then(data => { allProducts = data; loadingDiv.style.display = 'none'; })
            .catch(() => { 
                loadingDiv.style.display = 'none'; 
                allProducts = [
                    {name:"Ø¢ÙˆÛŒØ´Ù†", category:"Ú¯ÛŒØ§Ù‡Ø§Ù†-Ø¯Ø§Ø±ÙˆÛŒÛŒ", unit:"Ú¯Ø±Ù…", available:true},
                    {name:"Ø²Ø±Ø¯Ú†ÙˆØ¨Ù‡", category:"Ø§Ø¯ÙˆÛŒÙ‡-Ø¬Ø§Øª", unit:"Ú¯Ø±Ù…", available:true},
                    {name:"Ú¯Ù„Ø§Ø¨", category:"Ø¹Ø±Ù‚ÛŒØ§Øª", unit:"Ù„ÛŒØªØ±", available:true},
                    {name:"Ø±ÙˆØºÙ† Ú©Ù†Ø¬Ø¯", category:"Ø±ÙˆØºÙ†-Ù‡Ø§", unit:"Ù„ÛŒØªØ±", available:true}
                ];
            });

            // --- Ø¨Ø®Ø´ Ø³ÙØ§Ø±Ø´ Ø®Ø§Øµ ---
            window.sendSpecialRequest = function() {
                const n = document.getElementById('special-name').value;
                const d = document.getElementById('special-details').value;
                if(!n) return alert('Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„ Ø§Ù„Ø²Ø§Ù…ÛŒ Ø§Ø³Øª');
                window.open(`https://wa.me/${whatsappNumber}?text=${encodeURIComponent(`Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø®Ø§Øµ:\nÙ…Ø­ØµÙˆÙ„: ${n}\nØªÙˆØ¶ÛŒØ­Ø§Øª: ${d}`)}`, '_blank');
            }

            // ==========================================
            // === Ù…Ù†Ø·Ù‚  Ù…ÛŒÚ©Ø³Ø± (Ø¯Ø³Øª Ù†Ø®ÙˆØ±Ø¯Ù‡) ===
            // ==========================================
            
            let mixerConfig = { max: 1000, step: 100 };
            let currentFlaskWeight = 0;
            let flaskIngredients = [];
            let mixCounter = 1;

            const jarColors = [
                '#FF6B6B', '#4ECDC4', '#FFE66D', '#FF9F43', '#54A0FF', 
                '#5F27CD', '#C4E538', '#FDA7DF', '#D980FA', '#B53471',
                '#009432', '#F79F1F', '#1B1464', '#EA2027', '#A3CB38',
                '#12CBC4', '#ED4C67', '#B53471', '#833471', '#6F1E51'
            ];

            window.setMixerSize = function(max, step, btn) {
                if(currentFlaskWeight > 0) {
                    if(!confirm("Ø¨Ø§ ØªØºÛŒÛŒØ± Ø³Ø§ÛŒØ²ØŒ Ù…Ø­ØªÙˆÛŒØ§Øª ÙØ¹Ù„ÛŒ Ø¸Ø±Ù Ø®Ø§Ù„ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø§Ø¯Ø§Ù…Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡ÛŒØ¯ØŸ")) return;
                    resetFlask();
                }
                mixerConfig = { max, step };
                document.querySelectorAll('.size-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            }

            function resetFlask() {
                currentFlaskWeight = 0;
                flaskIngredients = [];
                document.getElementById('flask-content').innerHTML = '';
                document.getElementById('current-weight').textContent = '0';
            }

            window.initMixer = function() {
                const shelf = document.getElementById('shelf');
                if(shelf.children.length > 0) return; 

                for(let i=1; i<=20; i++) {
                    const color = jarColors[(i-1) % jarColors.length];
                    const div = document.createElement('div');
                    div.className = 'supplement-jar';
                    div.setAttribute('data-name', `Ù…Ú©Ù…Ù„ ${i}`);
                    div.setAttribute('data-color', color);
                    
                    div.innerHTML = `
                        <div class="jar-lid"></div>
                        <div class="jar-body" style="background:${color}"><span style="color:#fff">Ù…Ú©Ù…Ù„ ${i}</span></div>
                    `;
                    
                    div.draggable = true;
                    div.addEventListener('dragstart', handleDragStart);
                    div.addEventListener('touchstart', handleTouchStart, {passive: false});
                    div.addEventListener('touchmove', handleTouchMove, {passive: false});
                    div.addEventListener('touchend', handleTouchEnd);
                    shelf.appendChild(div);
                }

                const target = document.getElementById('flask-target');
                target.addEventListener('dragover', e => e.preventDefault());
                target.addEventListener('drop', handleDrop);
            }

            let draggedData = null;
            const ghost = document.getElementById('drag-ghost');

            function handleDragStart() { 
                draggedData = { name: this.dataset.name, color: this.dataset.color }; 
            }
            function handleDrop(e) { 
                e.preventDefault(); 
                if(draggedData) addIngredient(draggedData); 
            }

            function handleTouchStart(e) {
                e.preventDefault();
                const t = e.touches[0];
                draggedData = { name: this.dataset.name, color: this.dataset.color };
                ghost.style.display = 'flex';
                ghost.style.background = draggedData.color;
                ghost.innerHTML = '<i class="fa-solid fa-cube"></i>';
                moveGhost(t.clientX, t.clientY);
            }
            function handleTouchMove(e) { e.preventDefault(); moveGhost(e.touches[0].clientX, e.touches[0].clientY); }
            function handleTouchEnd(e) {
                ghost.style.display = 'none';
                const t = e.changedTouches[0];
                const rect = document.getElementById('flask-target').getBoundingClientRect();
                if (t.clientX >= rect.left && t.clientX <= rect.right && t.clientY >= rect.top && t.clientY <= rect.bottom) {
                    if(draggedData) addIngredient(draggedData);
                }
                draggedData = null;
            }
            function moveGhost(x, y) { ghost.style.left = (x-25)+'px'; ghost.style.top = (y-25)+'px'; }

            function addIngredient(item) {
                if (currentFlaskWeight >= mixerConfig.max) {
                    alert("Ø¸Ø±Ù Ù¾Ø± Ø´Ø¯Ù‡ Ø§Ø³Øª!");
                    return;
                }

                currentFlaskWeight += mixerConfig.step;
                document.getElementById('current-weight').textContent = currentFlaskWeight;

                const layer = document.createElement('div');
                layer.className = 'powder-layer';
                const percentHeight = (mixerConfig.step / mixerConfig.max) * 100;
                layer.style.height = percentHeight + '%';
                layer.style.backgroundColor = item.color;
                document.getElementById('flask-content').appendChild(layer);

                createParticles(item.color);
                flaskIngredients.push(item.name);

                if (currentFlaskWeight >= mixerConfig.max) {
                    setTimeout(finishMixing, 600);
                }
            }

            function createParticles(color) {
                const flask = document.getElementById('flask-target');
                for(let i=0; i<5; i++) {
                    const p = document.createElement('div');
                    p.className = 'particle';
                    p.style.backgroundColor = color;
                    p.style.left = (40 + Math.random() * 20) + '%'; 
                    p.style.animationDuration = (0.5 + Math.random() * 0.5) + 's';
                    flask.appendChild(p);
                    setTimeout(() => p.remove(), 1000);
                }
            }

            function finishMixing() {
                const mixId = Date.now(); 
                const counts = {};
                flaskIngredients.forEach(x => counts[x] = (counts[x] || 0) + 1);
                
                let detailsStr = Object.entries(counts)
                    .map(([k, v]) => `${k} (${v * mixerConfig.step}g)`).join('ØŒ ');

                let weightLabel = mixerConfig.max >= 1000 ? (mixerConfig.max/1000 + " Ú©ÛŒÙ„ÙˆÚ¯Ø±Ù…") : (mixerConfig.max + " Ú¯Ø±Ù…");
                const mixName = `Ù…ÛŒÚ©Ø³ Ø§Ø®ØªØµØ§ØµÛŒ ${mixCounter} (${weightLabel})`;

                const newMix = {
                    id: mixId,
                    name: mixName,
                    quantity: 1, 
                    unit: "Ø¹Ø¯Ø¯",
                    weightLabel: weightLabel,
                    type: "mix",
                    details: detailsStr
                };
                mixedProducts.push(newMix);

                const list = document.getElementById('mix-list');
                if(mixCounter === 1) list.innerHTML = '';

                const row = document.createElement('div');
                row.className = 'mix-item';
                row.id = `mix-row-${mixId}`;
                row.innerHTML = `
                    <div>
                        <span style="font-weight:bold; display:block;">${mixName}</span>
                        <span style="font-size:0.7rem; color:#777;">${detailsStr.substring(0,30)}...</span>
                    </div>
                    <button class="delete-mix-btn" onclick="removeMix(${mixId})">
                        <i class="fa-solid fa-trash"></i>
                    </button>
                `;
                list.appendChild(row);

                mixCounter++;
                alert(`"${mixName}" Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯ Ùˆ Ø¨Ù‡ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø§Ø¶Ø§ÙÙ‡ Ú¯Ø±Ø¯ÛŒØ¯.`);
                resetFlask();
                updateCartAndButton();
            }

            window.removeMix = function(id) {
                if(!confirm("Ø§ÛŒÙ† ØªØ±Ú©ÛŒØ¨ Ø­Ø°Ù Ø´ÙˆØ¯ØŸ")) return;
                mixedProducts = mixedProducts.filter(p => p.id !== id);
                const row = document.getElementById(`mix-row-${id}`);
                if(row) row.remove();
                if(mixedProducts.length === 0) {
                    document.getElementById('mix-list').innerHTML = '<small style="color: #999; display:block; text-align:center;">Ù‡Ù†ÙˆØ² ØªØ±Ú©ÛŒØ¨ÛŒ Ù†Ø³Ø§Ø®ØªÙ‡â€ŒØ§ÛŒØ¯.</small>';
                    mixCounter = 1; 
                }
                updateCartAndButton();
            }
        });
    </script>
</body>
</html>
